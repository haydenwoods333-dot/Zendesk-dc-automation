{% comment %}============================================Assigning execution {% endcomment %}
{% if hipaa_fail == "1" %}
  {% assign execution_state = "hipaa_denied" %}
{% elsif member == "missing" %}
  {% assign execution_state = "member_not_found" %}
{% elsif ticket.ticket_fields_encryption == "1" %}
  {% assign execution_state = "encryption" %}
{% else %}
  {% assign execution_state = "normal" %}
{% endif %}

{% comment %}===========================================EXTERNAL CONTENT {% endcomment %}
{% if macro_comment == "external" %}
{{dc.block_uni_greeting}}

{% comment %}===========================================INTERNAL NOTE {% endcomment %}
{% elsif macro_comment == "internal" %}
{{dc.block_requester_requester_id}}
{% endif %}

{% comment %}===========================================Block gates {% endcomment %}
{% case execution_state %}
  {% when "encryption" %}

    {{dc.block_gate_encryption}}

  {% when "hipaa_denied" %}
  
    {{dc.block_gate_hipaa_deny}}

  {% when "member_not_found" %}
    {{dc.block_gate_null_member}}


{% comment %}===========================================Then subcontroller for contact reason {% endcomment %}
  {% when "normal" %}
    {% case contact_reason %}

  {% when "claim_status" %}
    {{dc.sub_controller_claim_status}}

  {% when "eligibility" %}
    {{dc.sub_controller_eligibility_benefits}}

  {% endcase %}

{% endcase %}

{% comment %} Debug Output for Each Assigned Variable {% endcomment %}

{% if debug_mode == "enabled" %}

claim status = {{claim.claim_status}}

execution_state = {{ execution_state }}
audience = {{ audience }}
contact_reason = {{ contact_reason }}
group = {{ group }}
member = {{ member }}
claim = {{ claim }}
clm_batch = {{ clm_batch }}

member_dob = {{ member_dob }}
member_enroll_date = {{ member_enroll_date }}
member_termed_date = {{ member_termed_date }}

claim_received_date = {{ claim_received_date }}
claim_processed_date = {{ claim_processed_date }}
claim_dos = {{ claim_dos }}

clm_batch_received_date = {{ clm_batch_received_date }}
clm_batch_dos = {{ clm_batch_dos }}

hipaa_fail = {{ hipaa_fail }}
payment_released = {{ payment_released }}
payment_released_date = {{ payment_released_date }}
payment_cleared = {{ payment_cleared }}
payment_cleared_date = {{ payment_cleared_date }}
missing_claim_billed_amount = {{ missing_claim_billed_amount }}
missing_claim_dos = {{ missing_claim_dos }}

status = {{ status }}
display_status = {{ display_status }}
debug_mode = {{ debug_mode }}
macro_comment = {{ macro_comment }}

{% comment %} Debug Output for Each Assigned Variable with Actual Ticket Field Keys {% endcomment %}

execution_state = {{ execution_state }}

audience = {{ ticket.ticket_field_46911473232923 }}
contact_reason = {{ ticket.ticket_field_46911442746779 }}
group = {{ ticket.ticket_fields_46911520501915.custom_fields }}
member = {{ ticket.ticket_fields_46911443315867.custom_fields }}
claim = {{ ticket.ticket_fields_46911507367195.custom_fields }}
clm_batch = {{ ticket.ticket_fields_46902798796187.custom_fields }}

member_dob = {{ member_dob }}
member_enroll_date = {{ member_enroll_date }}
member_termed_date = {{ member_termed_date }}

claim_received_date = {{ claim_received_date }}
claim_processed_date = {{ claim_processed_date }}
claim_dos = {{ claim_dos }}

clm_batch_received_date = {{ clm_batch_received_date }}
clm_batch_dos = {{ clm_batch_dos }}

hippa_fail = {{ ticket.ticket_field_46911473844123 }}
payment_released = {{ ticket.ticket_field_46911520904347 }}
payment_released_date = {{ payment_released_date }}
payment_cleared = {{ ticket.ticket_field_46911458556443 }}
payment_cleared_date = {{ payment_cleared_date }}
missing_claim_billed_amount = {{ ticket.ticket_field_46911443267867 }}
missing_claim_dos = {{ ticket.ticket_field_46911520953883 }}

status = {{ status }}
display_status = {{ display_status }}
debug_mode = {{ debug_mode }}
macro_comment = {{ macro_comment }}
{% endif %}